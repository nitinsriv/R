Methodology:
  
Weeks are computed starting from January 2015.Fir eg., first week ended on 3rd January 2015.

Weekly PaymentType data is computed by aggregating given Daily Transactional Data over weeks. 
Most Frequent PaymentType used in all orders of that week is considered as PaymentType fpr that week. 
Refer computeFrequency method 

Investment for each month is splitted into daily investment equally and then daily investment data is
     aggregated for each week to generate weekly investment data.

Discount is computed for each order by deducting GMV from product of no. of units sold and product mrp.
Weekly Discount data is generated from median valye of discounts for all orders of that week.

Weekly delbdays data is generated from median valye of delbdays for all orders of that week.

Weekly delbcays data is generated from median valye of delbcays for all orders of that week.

All data is ordered by weeks. Promotion Weeks are marked.



EDA:

NA check done for GMV, cust_id and pincode. 
There are 4904 orders with missing information for cust_id, GMV and pincode. 
All these orders are removed.

NA check done for product_mrp column. 
There are 3145 orders in Camera Accessories segment with missing values for product_mrp.
These orders were removed.

There are 217 orders in Gaming Accessories segment with missing values for product_mrp.
These orders were removed.

There are 60 orders in Home Audio segment with missing values for product_mrp.
These orders were removed.


delbdays has some negative values for all three categories. Number of days can not be negative.
There are 6 orders in Camera Accessories segment with values less than zero.
These orders were removed.

There is 1 order in Gaming Accessories segment with values less than zero.
This order was removed.

There are 3 orders in Home Audio segment with values less than zero.
These orders were removed.


delcdays column also checked for negative values. All orders with negative values already found removed.


sla column checked for negative values.
There are 4073 orders in Camera Accessories segment with values less than zero.
These orders were removed.

There are 3470 orders in Gaming Accessories segment with values less than zero.
This order was removed.

There are 4202 orders in Home Audio segment with values less than zero.
These orders were removed.

Typos check done for product_analytic_sub_category column

New Discount column added for all three categories.

Weeks with missing value of NPS and different media investment types in merged dataframes of each category
are equated to 1 instead of 0, to avoid Inf values. log(0) is infinite.

Weeks with no orders reported in that week are removed. 

Outlier treatment done on NPS column and Discount column for all three categories.

Scaling done on media investments columns and their respective lag columns.


Graphs:

Monthly Sales and Total Investment plotted for each month in same plot all three categories.
Weekly Sales and all 7 media Investment plotted for each week for all three categories.


Model Generation/Evaluation:

Train-Test split of 70:30 mantained for model evaluation.
All 5 market mix models and an additional mixed model generated and evaluated.
Interaction variable analysis done and model generated.
RMSE on Test dtatset and adjusted R square used as metric for model evaluation.



###############################################################################################################################################################
#   # Category               # Basic Linear Regression     #  Multiplicative  #  Koyck               #  Distributed Lag #     Mixed
###############################################################################################################################################################
#   #                        #                             #                  #                      #       		      #
#   Camera Accessories       #                             #                  #                      #                        #
      adj. R square:	     # 0.5095		           # 0.9152           # 0.5095	             # 0.5095		      # 0.2934     
      RMSE on test:          # 2345414                     # 1968154          # 2345414              # 2345414                # 2719685
      Singnificant Variables # PromotionWeek, NPS ,        # ContentMarketing # PromotionWeek, NPS , # PromotionWeek, NPS ,   # SEMLag, interaction variable: 
		             # Sponsorship                 #                  # Sponsorship          # Sponsorship            # TVLag*ContentMarketingLag
#   
#   Gaming Accesories
#     adj. R square:	     # 0.5345		           # 0.6315           # 0.3044	             # 0.3044		      # 0.3501     
      RMSE on test:          # 1509094			   # 1042405          # 1438992              # 1438992                # 2513942
      Singnificant Variables # SEM, Affliates, Sponsorship # ContentMarketing # Affliates            # Affliates              # interaction variable: 
		             #                             #                  #                      #                        # TVLag*ContentMarketingLag
#   
#   Home Audio
#     adj. R square:	     # 0.4543		           # 0.7192           # 0.601	             # 0.4724		      # 0.8061
      RMSE on test:          # 2705055			   # 1816283          # 3274922              # 2541250                # 2365752
      Singnificant Variables # ContentMarketing, Discount  # TV               # Discount, NPS,       # PromotionWeek,         # interaction variable: 
		             #                             #                  # PromotionWeek,       # ContentMarketing       # Discount*NPS,
                                                                              # salesLage,                                    # ContentMarketing
                                                                              # ContentMarketing


Insights:

Sales with Payment Type of COD is higher for all categories. 
Graph for Weekly Sales and Digital Investment plotted for each week for Camera Accesories shows 2 weeks lag.
Graph for Weekly Sales and Digital and Online Investment plotted for each week for Gaming Accesories shows 2 weeks lag.
Graph for Weekly Sales and SEM investment plotted for each week for Home Audio shows 1 week lag.
Graph for Weekly Sales and Affliates investment plotted for each week for Home Audio shows 2 weeks lag.


Assumptions: 
  
  1. NPS for each week is same as NPS for the month of that week.
  2. For weeks where number of COD payments is equal to number of Prepaid, COD paymenttpe is considered for that week.



